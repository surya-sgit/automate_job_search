name: Daily Job Hunt

on:
  schedule:
    - cron: '30 3 * * *'  # Runs at 9:00 AM IST (03:30 UTC)
  workflow_dispatch:      # Allows manual trigger

jobs:
  run-scraper:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Code
        uses: actions/checkout@v3

      - name: Install uv
        uses: astral-sh/setup-uv@v5

      - name: Install Python & Dependencies
        run: uv sync --frozen
        # 'uv sync' reads pyproject.toml and installs everything.
        # '--frozen' ensures it uses the exact versions from uv.lock.

      - name: Create Credentials File
        run: echo '${{ secrets.GOOGLE_CREDS_JSON }}' > credentials.json

      - name: Run Job Hunter Agent
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: uv run main.py